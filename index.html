<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>跨境电商定价计算器</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #4a6fa5 0%, #2c3e50 100%);
            color: white;
            padding: 25px 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 28px;
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .subtitle {
            font-size: 16px;
            opacity: 0.9;
        }
        
        .platform-tabs {
            display: flex;
            background-color: #f0f2f5;
            border-bottom: 1px solid #e1e5eb;
        }
        
        .tab {
            padding: 18px 30px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            color: #555;
        }
        
        .tab.active {
            background-color: white;
            color: #4a6fa5;
            border-bottom: 3px solid #4a6fa5;
        }
        
        .tab:hover:not(.active) {
            background-color: #e8ecf1;
        }
        
        .country-tabs {
            display: flex;
            background-color: #f8f9fa;
            padding: 15px 30px;
            border-bottom: 1px solid #e1e5eb;
        }
        
        .country-tab {
            padding: 10px 20px;
            margin-right: 10px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            background-color: #e9ecef;
            color: #495057;
            transition: all 0.2s;
        }
        
        .country-tab.active {
            background-color: #4a6fa5;
            color: white;
        }
        
        .calculator-container {
            display: none;
            padding: 25px 30px;
        }
        
        .calculator-container.active {
            display: block;
        }
        
        .input-section {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 1px solid #eaeaea;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
        }
        
        .input-group label {
            font-weight: 500;
            margin-bottom: 8px;
            color: #444;
            font-size: 14px;
        }
        
        .input-group input, .input-group select {
            padding: 12px 15px;
            border: 1px solid #d1d9e6;
            border-radius: 6px;
            font-size: 15px;
            transition: border 0.3s;
        }
        
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #4a6fa5;
            box-shadow: 0 0 0 2px rgba(74, 111, 165, 0.1);
        }
        
        .calculate-btn {
            background: linear-gradient(to right, #4a6fa5, #3a5980);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 20px 0 30px;
            display: block;
            width: 100%;
        }
        
        .calculate-btn:hover {
            background: linear-gradient(to right, #3a5980, #2c3e50);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .results-section {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .result-card {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            border-left: 4px solid #4a6fa5;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .result-card h3 {
            font-size: 16px;
            color: #555;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .result-value {
            font-size: 24px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .result-value.profit {
            color: #27ae60;
        }
        
        .result-value.loss {
            color: #e74c3c;
        }
        
        .result-unit {
            font-size: 14px;
            color: #7f8c8d;
            margin-left: 5px;
        }
        
        .note {
            margin-top: 30px;
            padding: 15px;
            background-color: #f0f7ff;
            border-radius: 6px;
            font-size: 14px;
            color: #555;
            border-left: 4px solid #4a6fa5;
        }
        
        .note strong {
            color: #2c3e50;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            color: #7f8c8d;
            font-size: 14px;
            border-top: 1px solid #eee;
        }
        
        @media (max-width: 768px) {
            .platform-tabs, .country-tabs {
                flex-wrap: wrap;
            }
            
            .tab, .country-tab {
                flex: 1;
                min-width: 120px;
                text-align: center;
            }
            
            .input-section, .results-section {
                grid-template-columns: 1fr;
            }
            
            .container {
                border-radius: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>跨境电商定价计算器</h1>
            <p class="subtitle">Shopee & Lazada 平台利润计算工具</p>
        </header>
        
        <div class="platform-tabs">
            <div class="tab active" data-platform="shopee">Shopee 平台</div>
            <div class="tab" data-platform="lazada">Lazada 平台</div>
        </div>
        
        <!-- Shopee 平台 -->
        <div id="shopee-calculator" class="calculator-container active">
            <div class="country-tabs">
                <div class="country-tab active" data-country="vietnam">跨境越南</div>
                <div class="country-tab" data-country="thailand">跨境泰国</div>
                <div class="country-tab" data-country="local">本土版(泰国)</div>
            </div>
            
            <!-- 跨境越南 -->
            <div id="shopee-vietnam" class="country-calculator">
                <div class="input-section">
                    <div class="input-group">
                        <label for="sv-quantity">件数</label>
                        <input type="number" id="sv-quantity" value="1" min="1" step="1">
                    </div>
                    <div class="input-group">
                        <label for="sv-price">售价 (越南盾)</label>
                        <input type="number" id="sv-price" value="80000" min="0">
                    </div>
                    <div class="input-group">
                        <label for="sv-purchase">采购价 (人民币)</label>
                        <input type="number" id="sv-purchase" value="13" min="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="sv-weight">重量 (克)</label>
                        <input type="number" id="sv-weight" value="100" min="0">
                    </div>
                    <div class="input-group">
                        <label for="sv-exchange-rate">汇率 (越南盾/人民币)</label>
                        <input type="number" id="sv-exchange-rate" value="3700" min="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="sv-discount">上架折扣</label>
                        <input type="number" id="sv-discount" value="0.4" min="0" max="1" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="sv-bundle">捆绑套装比率</label>
                        <input type="number" id="sv-bundle" value="0" min="0" max="1" step="0.01">
                    </div>
                </div>
                
                <button class="calculate-btn" onclick="calculateShopeeVietnam()">计算利润</button>
                
                <div class="results-section">
                    <div class="result-card">
                        <h3>总成本 (人民币)</h3>
                        <div class="result-value" id="sv-total-cost">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>总收入 (人民币)</h3>
                        <div class="result-value" id="sv-total-income">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>毛利 (人民币)</h3>
                        <div class="result-value" id="sv-profit">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>毛利率</h3>
                        <div class="result-value" id="sv-profit-rate">0.00%</div>
                    </div>
                    <div class="result-card">
                        <h3>上架价格 (越南盾)</h3>
                        <div class="result-value" id="sv-listing-price">0<span class="result-unit">越南盾</span></div>
                    </div>
                    <div class="result-card">
                        <h3>含税价格 (越南盾)</h3>
                        <div class="result-value" id="sv-tax-price">0<span class="result-unit">越南盾</span></div>
                    </div>
                </div>
                
                <div class="note">
                    <strong>计算说明：</strong> 跨境越南计算包含仓储成本(1.4元)、交易手续费(4.91%)、服务费(5%)、干线运输费、佣金(15.33%)、联盟营销(1%)和平台费(13800越南盾)。
                </div>
            </div>
            
            <!-- 跨境泰国 -->
            <div id="shopee-thailand" class="country-calculator" style="display: none;">
                <div class="input-section">
                    <div class="input-group">
                        <label for="st-quantity">件数</label>
                        <input type="number" id="st-quantity" value="1" min="1" step="1">
                    </div>
                    <div class="input-group">
                        <label for="st-price">售价 (泰铢)</label>
                        <input type="number" id="st-price" value="160" min="0">
                    </div>
                    <div class="input-group">
                        <label for="st-purchase">采购价 (人民币)</label>
                        <input type="number" id="st-purchase" value="4.9" min="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="st-weight">重量 (克)</label>
                        <input type="number" id="st-weight" value="100" min="0">
                    </div>
                    <div class="input-group">
                        <label for="st-exchange-rate">汇率 (泰铢/人民币)</label>
                        <input type="number" id="st-exchange-rate" value="5" min="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="st-discount">上架折扣</label>
                        <input type="number" id="st-discount" value="0.4" min="0" max="1" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="st-bundle">捆绑套装比率</label>
                        <input type="number" id="st-bundle" value="0" min="0" max="1" step="0.01">
                    </div>
                </div>
                
                <button class="calculate-btn" onclick="calculateShopeeThailand()">计算利润</button>
                
                <div class="results-section">
                    <div class="result-card">
                        <h3>总成本 (人民币)</h3>
                        <div class="result-value" id="st-total-cost">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>总收入 (人民币)</h3>
                        <div class="result-value" id="st-total-income">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>毛利 (人民币)</h3>
                        <div class="result-value" id="st-profit">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>毛利率</h3>
                        <div class="result-value" id="st-profit-rate">0.00%</div>
                    </div>
                    <div class="result-card">
                        <h3>上架价格 (泰铢)</h3>
                        <div class="result-value" id="st-listing-price">0<span class="result-unit">泰铢</span></div>
                    </div>
                    <div class="result-card">
                        <h3>含税价格 (泰铢)</h3>
                        <div class="result-value" id="st-tax-price">0<span class="result-unit">泰铢</span></div>
                    </div>
                </div>
                
                <div class="note">
                    <strong>计算说明：</strong> 跨境泰国计算包含仓储成本(1.4元)、交易手续费(3.21%)、服务费(5.35%)、干线运输费(0.006元/克)、佣金(18.19%)、联盟营销(1%)和平台费(1.07泰铢)。
                </div>
            </div>
            
            <!-- 本土版(泰国) -->
            <div id="shopee-local" class="country-calculator" style="display: none;">
                <div class="input-section">
                    <div class="input-group">
                        <label for="sl-quantity">件数</label>
                        <input type="number" id="sl-quantity" value="1" min="1" step="1">
                    </div>
                    <div class="input-group">
                        <label for="sl-price">售价 (泰铢)</label>
                        <input type="number" id="sl-price" value="35" min="0">
                    </div>
                    <div class="input-group">
                        <label for="sl-purchase">采购价 (人民币)</label>
                        <input type="number" id="sl-purchase" value="2.6" min="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="sl-weight">重量 (克)</label>
                        <input type="number" id="sl-weight" value="50" min="0">
                    </div>
                    <div class="input-group">
                        <label for="sl-exchange-rate">汇率 (泰铢/人民币)</label>
                        <input type="number" id="sl-exchange-rate" value="5" min="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="sl-discount">上架折扣</label>
                        <input type="number" id="sl-discount" value="0.4" min="0" max="1" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="sl-coupon">优惠券比率</label>
                        <input type="number" id="sl-coupon" value="0.05" min="0" max="1" step="0.01">
                    </div>
                </div>
                
                <button class="calculate-btn" onclick="calculateShopeeLocal()">计算利润</button>
                
                <div class="results-section">
                    <div class="result-card">
                        <h3>总成本 (人民币)</h3>
                        <div class="result-value" id="sl-total-cost">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>总收入 (人民币)</h3>
                        <div class="result-value" id="sl-total-income">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>毛利 (人民币)</h3>
                        <div class="result-value" id="sl-profit">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>毛利率</h3>
                        <div class="result-value" id="sl-profit-rate">0.00%</div>
                    </div>
                    <div class="result-card">
                        <h3>上架价格 (泰铢)</h3>
                        <div class="result-value" id="sl-listing-price">0<span class="result-unit">泰铢</span></div>
                    </div>
                    <div class="result-card">
                        <h3>含税价格 (泰铢)</h3>
                        <div class="result-value" id="sl-tax-price">0<span class="result-unit">泰铢</span></div>
                    </div>
                </div>
                
                <div class="note">
                    <strong>计算说明：</strong> 本土版计算包含仓储成本(1.7元)、交易手续费(3.21%)、FCSS+CCB(7.49%)、陆运干线(0.0095元/克)、佣金(8.56%)、优惠券(5%)、联盟营销(1%)和平台费(1.07泰铢)。
                </div>
            </div>
        </div>
        
        <!-- Lazada 平台 -->
        <div id="lazada-calculator" class="calculator-container">
            <div class="country-tabs">
                <div class="country-tab active" data-country="vietnam">越南跨境</div>
                <div class="country-tab" data-country="thailand">泰国跨境</div>
                <div class="country-tab" data-country="thai-sea">泰国海运</div>
            </div>
            
            <!-- 越南跨境 -->
            <div id="lazada-vietnam" class="country-calculator">
                <div class="input-section">
                    <div class="input-group">
                        <label for="lv-quantity">件数</label>
                        <input type="number" id="lv-quantity" value="1" min="1" step="1">
                    </div>
                    <div class="input-group">
                        <label for="lv-price">售价 (越南盾)</label>
                        <input type="number" id="lv-price" value="78200" min="0">
                    </div>
                    <div class="input-group">
                        <label for="lv-purchase">采购价 (人民币)</label>
                        <input type="number" id="lv-purchase" value="9" min="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="lv-weight">重量 (克)</label>
                        <input type="number" id="lv-weight" value="250" min="0">
                    </div>
                    <div class="input-group">
                        <label for="lv-exchange-rate">汇率 (越南盾/人民币)</label>
                        <input type="number" id="lv-exchange-rate" value="3700" min="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="lv-discount">上架折扣</label>
                        <input type="number" id="lv-discount" value="0.4" min="0" max="1" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="lv-subsidy">补贴 (越南盾)</label>
                        <input type="number" id="lv-subsidy" value="10500" min="0">
                    </div>
                </div>
                
                <button class="calculate-btn" onclick="calculateLazadaVietnam()">计算利润</button>
                
                <div class="results-section">
                    <div class="result-card">
                        <h3>总成本 (人民币)</h3>
                        <div class="result-value" id="lv-total-cost">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>总收入 (人民币)</h3>
                        <div class="result-value" id="lv-total-income">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>毛利 (人民币)</h3>
                        <div class="result-value" id="lv-profit">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>毛利率</h3>
                        <div class="result-value" id="lv-profit-rate">0.00%</div>
                    </div>
                    <div class="result-card">
                        <h3>上架价格 (越南盾)</h3>
                        <div class="result-value" id="lv-listing-price">0<span class="result-unit">越南盾</span></div>
                    </div>
                    <div class="result-card">
                        <h3>尾程运费 (人民币)</h3>
                        <div class="result-value" id="lv-shipping">0.00<span class="result-unit">元</span></div>
                    </div>
                </div>
                
                <div class="note">
                    <strong>计算说明：</strong> Lazada越南跨境计算包含仓储成本(1.4元)、交易手续费(4.15%)、佣金(13.35%)、干线运输费(0.008元/克)、尾程运费、补贴、超级联盟(1%)、活动佣金(1%)、金币抵扣(1%)和平台费。
                </div>
            </div>
            
            <!-- 泰国跨境 -->
            <div id="lazada-thailand" class="country-calculator" style="display: none;">
                <div class="input-section">
                    <div class="input-group">
                        <label for="lt-quantity">件数</label>
                        <input type="number" id="lt-quantity" value="1" min="1" step="1">
                    </div>
                    <div class="input-group">
                        <label for="lt-price">售价 (泰铢)</label>
                        <input type="number" id="lt-price" value="64" min="0">
                    </div>
                    <div class="input-group">
                        <label for="lt-purchase">采购价 (人民币)</label>
                        <input type="number" id="lt-purchase" value="7.1" min="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="lt-weight">重量 (克)</label>
                        <input type="number" id="lt-weight" value="100" min="0">
                    </div>
                    <div class="input-group">
                        <label for="lt-exchange-rate">汇率 (泰铢/人民币)</label>
                        <input type="number" id="lt-exchange-rate" value="5" min="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="lt-discount">上架折扣</label>
                        <input type="number" id="lt-discount" value="0.4" min="0" max="1" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="lt-coupon">优惠券比率</label>
                        <input type="number" id="lt-coupon" value="0.05" min="0" max="1" step="0.01">
                    </div>
                </div>
                
                <button class="calculate-btn" onclick="calculateLazadaThailand()">计算利润</button>
                
                <div class="results-section">
                    <div class="result-card">
                        <h3>总成本 (人民币)</h3>
                        <div class="result-value" id="lt-total-cost">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>总收入 (人民币)</h3>
                        <div class="result-value" id="lt-total-income">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>毛利 (人民币)</h3>
                        <div class="result-value" id="lt-profit">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>毛利率</h3>
                        <div class="result-value" id="lt-profit-rate">0.00%</div>
                    </div>
                    <div class="result-card">
                        <h3>上架价格 (泰铢)</h3>
                        <div class="result-value" id="lt-listing-price">0<span class="result-unit">泰铢</span></div>
                    </div>
                </div>
                
                <div class="note">
                    <strong>计算说明：</strong> Lazada泰国跨境计算包含仓储成本(1.4元)、交易手续费(3.21%)、FS+CB(4%)、干线运输费(0.025元/克)、佣金(11.24%)、优惠券(5%)、尾程运费(3元)、补贴(29泰铢)、超级联盟(1%)、活动佣金(1%)和金币抵扣(1%)。
                </div>
            </div>
            
            <!-- 泰国海运 -->
            <div id="lazada-thai-sea" class="country-calculator" style="display: none;">
                <div class="input-section">
                    <div class="input-group">
                        <label for="ls-quantity">件数</label>
                        <input type="number" id="ls-quantity" value="1" min="1" step="1">
                    </div>
                    <div class="input-group">
                        <label for="ls-price">售价 (泰铢)</label>
                        <input type="number" id="ls-price" value="75" min="0">
                    </div>
                    <div class="input-group">
                        <label for="ls-purchase">采购价 (人民币)</label>
                        <input type="number" id="ls-purchase" value="6" min="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="ls-weight">重量 (克)</label>
                        <input type="number" id="ls-weight" value="500" min="0">
                    </div>
                    <div class="input-group">
                        <label for="ls-exchange-rate">汇率 (泰铢/人民币)</label>
                        <input type="number" id="ls-exchange-rate" value="5" min="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="ls-discount">上架折扣</label>
                        <input type="number" id="ls-discount" value="0.4" min="0" max="1" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="ls-coupon">优惠券比率</label>
                        <input type="number" id="ls-coupon" value="0.05" min="0" max="1" step="0.01">
                    </div>
                </div>
                
                <button class="calculate-btn" onclick="calculateLazadaThaiSea()">计算利润</button>
                
                <div class="results-section">
                    <div class="result-card">
                        <h3>总成本 (人民币)</h3>
                        <div class="result-value" id="ls-total-cost">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>总收入 (人民币)</h3>
                        <div class="result-value" id="ls-total-income">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>毛利 (人民币)</h3>
                        <div class="result-value" id="ls-profit">0.00<span class="result-unit">元</span></div>
                    </div>
                    <div class="result-card">
                        <h3>毛利率</h3>
                        <div class="result-value" id="ls-profit-rate">0.00%</div>
                    </div>
                    <div class="result-card">
                        <h3>上架价格 (泰铢)</h3>
                        <div class="result-value" id="ls-listing-price">0<span class="result-unit">泰铢</span></div>
                    </div>
                </div>
                
                <div class="note">
                    <strong>计算说明：</strong> Lazada泰国海运计算包含仓储成本(1.4元)、交易手续费(3.21%)、FS+CB(4%)、干线运输费(0.006元/克)、佣金(11.24%)、优惠券(5%)、尾程运费(3元)、补贴(29泰铢)、超级联盟(1%)、活动佣金(1%)和金币抵扣(1%)。
                </div>
            </div>
        </div>
        
        <footer>
            <p>© 2023 跨境电商定价计算器 | 基于Excel定价表制作的网页版本 | 数据仅供参考，实际费用可能有所不同</p>
        </footer>
    </div>

    <script>
        // 切换平台
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // 更新标签状态
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // 切换计算器显示
                document.querySelectorAll('.calculator-container').forEach(calc => {
                    calc.classList.remove('active');
                });
                
                const platform = this.getAttribute('data-platform');
                document.getElementById(`${platform}-calculator`).classList.add('active');
                
                // 重置国家标签
                resetCountryTabs(platform);
            });
        });
        
        // 切换国家/地区
        document.querySelectorAll('.country-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const platform = document.querySelector('.platform-tabs .tab.active').getAttribute('data-platform');
                const country = this.getAttribute('data-country');
                
                // 更新标签状态
                const container = this.closest('.country-tabs');
                container.querySelectorAll('.country-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // 切换计算器显示
                const calculatorContainer = document.getElementById(`${platform}-calculator`);
                calculatorContainer.querySelectorAll('.country-calculator').forEach(calc => {
                    calc.style.display = 'none';
                });
                calculatorContainer.querySelector(`#${platform}-${country}`).style.display = 'block';
            });
        });
        
        function resetCountryTabs(platform) {
            const container = document.getElementById(`${platform}-calculator`);
            const tabs = container.querySelector('.country-tabs');
            const calculators = container.querySelectorAll('.country-calculator');
            
            // 重置标签
            tabs.querySelectorAll('.country-tab').forEach((tab, index) => {
                tab.classList.remove('active');
                if (index === 0) tab.classList.add('active');
            });
            
            // 重置计算器显示
            calculators.forEach((calc, index) => {
                calc.style.display = index === 0 ? 'block' : 'none';
            });
        }
        
        // Shopee越南计算函数
        function calculateShopeeVietnam() {
            const quantity = parseFloat(document.getElementById('sv-quantity').value);
            const price = parseFloat(document.getElementById('sv-price').value);
            const purchase = parseFloat(document.getElementById('sv-purchase').value);
            const weight = parseFloat(document.getElementById('sv-weight').value);
            const exchangeRate = parseFloat(document.getElementById('sv-exchange-rate').value);
            const discount = parseFloat(document.getElementById('sv-discount').value);
            const bundleRate = parseFloat(document.getElementById('sv-bundle').value);
            
            // 总售价
            const totalPrice = price * quantity;
            
            // 计算各项费用 (基于Excel公式)
            const coupon = 0; // 优惠券为0
            const bundle = totalPrice * bundleRate;
            
            // 交易手续费 (4.91%)
            const transactionFee = Math.round((totalPrice - coupon - bundle) * 0.0491);
            
            // 服务费 (5%)
            const serviceFee = Math.round((totalPrice - coupon - bundle) * 0.05);
            
            // 干线运输费 (根据重量查找，这里简化处理)
            const shippingRate = getShippingRate(weight * quantity, 'vietnam');
            const shippingFee = shippingRate / exchangeRate;
            
            // 佣金 (15.33%)
            const commission = Math.round((totalPrice - coupon - bundle) * 0.1533);
            
            // 联盟营销 (1%)
            const alliance = Math.round((totalPrice - coupon - bundle) * 0.01);
            
            // 平台费 (越南盾)
            const platformFee = 13800;
            
            // 仓储成本
            const storageCost = 1.4 * quantity;
            
            // 总成本 (人民币)
            const totalCost = (purchase * quantity) + storageCost + shippingFee;
            
            // 总收入 (人民币)
            const totalIncome = (totalPrice - transactionFee - serviceFee - commission - coupon - bundle - alliance - platformFee) / exchangeRate;
            
            // 毛利
            const profit = totalIncome - totalCost;
            
            // 毛利率
            const profitRate = totalIncome > 0 ? (profit / totalIncome) * 100 : 0;
            
            // 上架价格
            const listingPrice = totalPrice / (1 - discount);
            
            // 含税价格 (加10%税)
            const taxPrice = totalPrice + (totalPrice * 0.1);
            
            // 更新显示
            document.getElementById('sv-total-cost').innerHTML = `${totalCost.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('sv-total-income').innerHTML = `${totalIncome.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('sv-profit').innerHTML = `${profit.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('sv-profit-rate').innerHTML = `${profitRate.toFixed(2)}%`;
            document.getElementById('sv-listing-price').innerHTML = `${Math.round(listingPrice).toLocaleString()}<span class="result-unit">越南盾</span>`;
            document.getElementById('sv-tax-price').innerHTML = `${Math.round(taxPrice).toLocaleString()}<span class="result-unit">越南盾</span>`;
            
            // 设置颜色
            document.getElementById('sv-profit').className = `result-value ${profit >= 0 ? 'profit' : 'loss'}`;
            document.getElementById('sv-profit-rate').className = `result-value ${profitRate >= 0 ? 'profit' : 'loss'}`;
        }
        
        // Shopee泰国计算函数
        function calculateShopeeThailand() {
            const quantity = parseFloat(document.getElementById('st-quantity').value);
            const price = parseFloat(document.getElementById('st-price').value);
            const purchase = parseFloat(document.getElementById('st-purchase').value);
            const weight = parseFloat(document.getElementById('st-weight').value);
            const exchangeRate = parseFloat(document.getElementById('st-exchange-rate').value);
            const discount = parseFloat(document.getElementById('st-discount').value);
            const bundleRate = parseFloat(document.getElementById('st-bundle').value);
            
            // 总售价
            const totalPrice = price * quantity;
            
            // 计算各项费用
            const coupon = 0; // 优惠券为0
            const bundle = totalPrice * bundleRate;
            
            // 交易手续费 (3.21%)
            const transactionFee = Math.round((totalPrice - coupon - bundle) * 0.0321);
            
            // 服务费 (5.35%)
            const serviceFee = Math.round((totalPrice - coupon - bundle) * 0.0535);
            
            // 干线运输费 (0.006元/克)
            const shippingFee = (weight * quantity) * 0.006;
            
            // 佣金 (18.19%)
            const commission = Math.round((totalPrice - coupon - bundle) * 0.1819);
            
            // 联盟营销 (1%)
            const alliance = Math.round((totalPrice - coupon - bundle) * 0.01);
            
            // 平台费 (泰铢)
            const platformFee = 1.07 * quantity;
            
            // 仓储成本
            const storageCost = 1.4 * quantity;
            
            // 总成本 (人民币)
            const totalCost = (purchase * quantity) + storageCost + shippingFee;
            
            // 总收入 (人民币)
            const totalIncome = (totalPrice - transactionFee - serviceFee - commission - coupon - bundle - alliance - platformFee) / exchangeRate;
            
            // 毛利
            const profit = totalIncome - totalCost;
            
            // 毛利率
            const profitRate = totalIncome > 0 ? (profit / totalIncome) * 100 : 0;
            
            // 上架价格
            const listingPrice = totalPrice / (1 - discount);
            
            // 含税价格 (加7%税)
            const taxPrice = totalPrice + (totalPrice * 0.07);
            
            // 更新显示
            document.getElementById('st-total-cost').innerHTML = `${totalCost.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('st-total-income').innerHTML = `${totalIncome.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('st-profit').innerHTML = `${profit.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('st-profit-rate').innerHTML = `${profitRate.toFixed(2)}%`;
            document.getElementById('st-listing-price').innerHTML = `${Math.round(listingPrice).toLocaleString()}<span class="result-unit">泰铢</span>`;
            document.getElementById('st-tax-price').innerHTML = `${Math.round(taxPrice).toLocaleString()}<span class="result-unit">泰铢</span>`;
            
            // 设置颜色
            document.getElementById('st-profit').className = `result-value ${profit >= 0 ? 'profit' : 'loss'}`;
            document.getElementById('st-profit-rate').className = `result-value ${profitRate >= 0 ? 'profit' : 'loss'}`;
        }
        
        // Shopee本土版计算函数
        function calculateShopeeLocal() {
            const quantity = parseFloat(document.getElementById('sl-quantity').value);
            const price = parseFloat(document.getElementById('sl-price').value);
            const purchase = parseFloat(document.getElementById('sl-purchase').value);
            const weight = parseFloat(document.getElementById('sl-weight').value);
            const exchangeRate = parseFloat(document.getElementById('sl-exchange-rate').value);
            const discount = parseFloat(document.getElementById('sl-discount').value);
            const couponRate = parseFloat(document.getElementById('sl-coupon').value);
            
            // 总售价
            const totalPrice = price * quantity;
            
            // 计算各项费用
            const bundle = 0; // 套装加购为0
            const coupon = (totalPrice - bundle) * couponRate;
            
            // 交易手续费 (3.21%)
            const transactionFee = Math.round((totalPrice - coupon - bundle) * 0.0321);
            
            // FCSS+CCB (7.49%)
            const fcssCcb = Math.round((totalPrice - coupon - bundle) * 0.0749);
            
            // 陆运干线 (0.0095元/克)
            const shippingFee = (weight * quantity) * 0.0095;
            
            // 佣金 (8.56%)
            const commission = Math.round((totalPrice - coupon - bundle) * 0.0856);
            
            // 联盟营销 (1%)
            const alliance = Math.round((totalPrice - coupon - bundle) * 0.01);
            
            // 平台费 (泰铢)
            const platformFee = 1.07 * quantity;
            
            // 仓储成本
            const storageCost = 1.7 * quantity;
            
            // 总成本 (人民币)
            const totalCost = (purchase * quantity) + storageCost + shippingFee;
            
            // 总收入 (人民币)
            const totalIncome = (totalPrice - transactionFee - fcssCcb - commission - coupon - bundle - alliance - platformFee) / exchangeRate;
            
            // 毛利
            const profit = totalIncome - totalCost;
            
            // 毛利率
            const profitRate = totalIncome > 0 ? (profit / totalIncome) * 100 : 0;
            
            // 上架价格
            const listingPrice = totalPrice / (1 - discount);
            
            // 含税价格 (加7%税)
            const taxPrice = totalPrice + (totalPrice * 0.07);
            
            // 更新显示
            document.getElementById('sl-total-cost').innerHTML = `${totalCost.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('sl-total-income').innerHTML = `${totalIncome.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('sl-profit').innerHTML = `${profit.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('sl-profit-rate').innerHTML = `${profitRate.toFixed(2)}%`;
            document.getElementById('sl-listing-price').innerHTML = `${Math.round(listingPrice).toLocaleString()}<span class="result-unit">泰铢</span>`;
            document.getElementById('sl-tax-price').innerHTML = `${Math.round(taxPrice).toLocaleString()}<span class="result-unit">泰铢</span>`;
            
            // 设置颜色
            document.getElementById('sl-profit').className = `result-value ${profit >= 0 ? 'profit' : 'loss'}`;
            document.getElementById('sl-profit-rate').className = `result-value ${profitRate >= 0 ? 'profit' : 'loss'}`;
        }
        
        // Lazada越南计算函数
        function calculateLazadaVietnam() {
            const quantity = parseFloat(document.getElementById('lv-quantity').value);
            const price = parseFloat(document.getElementById('lv-price').value);
            const purchase = parseFloat(document.getElementById('lv-purchase').value);
            const weight = parseFloat(document.getElementById('lv-weight').value);
            const exchangeRate = parseFloat(document.getElementById('lv-exchange-rate').value);
            const discount = parseFloat(document.getElementById('lv-discount').value);
            const subsidy = parseFloat(document.getElementById('lv-subsidy').value);
            
            // 总售价
            const totalPrice = price * quantity;
            
            // 计算各项费用
            const coupon = 0; // 优惠券为0
            const bundle = 0; // 套装加购为0
            
            // 交易手续费 (4.15%)
            const transactionFee = Math.round((totalPrice - coupon - bundle) * 0.0415);
            
            // FS+CB (0%)
            const fsCb = 0;
            
            // 干线运输费 (0.008元/克)
            const shippingFee = (weight * quantity) * 0.008;
            
            // 佣金 (13.35%)
            const commission = Math.round((totalPrice - coupon - bundle) * 0.1335);
            
            // 尾程运费 (根据重量计算)
            const lastMileShipping = calculateLastMileShipping(weight * quantity);
            
            // 超级联盟 (1%)
            const superAlliance = Math.round((totalPrice - coupon - bundle) * 0.01);
            
            // 活动佣金 (1%)
            const activityCommission = Math.round((totalPrice - coupon - bundle) * 0.01);
            
            // 金币抵扣 (1%)
            const coinDeduction = Math.round((totalPrice - coupon - bundle) * 0.01);
            
            // 平台费
            const platformFee = 13800 * quantity;
            
            // 仓储成本
            const storageCost = 1.4 * quantity;
            
            // 总成本 (人民币)
            const totalCost = (purchase * quantity) + storageCost + shippingFee + lastMileShipping;
            
            // 总收入 (人民币)
            const totalIncome = (totalPrice - transactionFee - fsCb - commission - coupon - bundle + subsidy - superAlliance - activityCommission - coinDeduction - platformFee) / exchangeRate;
            
            // 毛利
            const profit = totalIncome - totalCost;
            
            // 毛利率
            const profitRate = totalIncome > 0 ? (profit / totalIncome) * 100 : 0;
            
            // 上架价格
            const listingPrice = totalPrice / (1 - discount);
            
            // 更新显示
            document.getElementById('lv-total-cost').innerHTML = `${totalCost.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('lv-total-income').innerHTML = `${totalIncome.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('lv-profit').innerHTML = `${profit.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('lv-profit-rate').innerHTML = `${profitRate.toFixed(2)}%`;
            document.getElementById('lv-listing-price').innerHTML = `${Math.round(listingPrice).toLocaleString()}<span class="result-unit">越南盾</span>`;
            document.getElementById('lv-shipping').innerHTML = `${lastMileShipping.toFixed(2)}<span class="result-unit">元</span>`;
            
            // 设置颜色
            document.getElementById('lv-profit').className = `result-value ${profit >= 0 ? 'profit' : 'loss'}`;
            document.getElementById('lv-profit-rate').className = `result-value ${profitRate >= 0 ? 'profit' : 'loss'}`;
        }
        
        // Lazada泰国计算函数
        function calculateLazadaThailand() {
            const quantity = parseFloat(document.getElementById('lt-quantity').value);
            const price = parseFloat(document.getElementById('lt-price').value);
            const purchase = parseFloat(document.getElementById('lt-purchase').value);
            const weight = parseFloat(document.getElementById('lt-weight').value);
            const exchangeRate = parseFloat(document.getElementById('lt-exchange-rate').value);
            const discount = parseFloat(document.getElementById('lt-discount').value);
            const couponRate = parseFloat(document.getElementById('lt-coupon').value);
            
            // 总售价
            const totalPrice = price * quantity;
            
            // 计算各项费用
            const bundle = 0; // 套装加购为0
            const coupon = (totalPrice - bundle) * couponRate;
            
            // 交易手续费 (3.21%)
            const transactionFee = Math.round((totalPrice - coupon - bundle) * 0.0321);
            
            // FS+CB (4%)
            const fsCb = Math.round((totalPrice - coupon - bundle) * 0.04);
            
            // 干线运输费 (0.025元/克)
            const shippingFee = (weight * quantity) * 0.025;
            
            // 佣金 (11.24%)
            const commission = Math.round((totalPrice - coupon - bundle) * 0.1124);
            
            // 尾程运费
            const lastMileShipping = 3 * quantity;
            
            // 补贴 (泰铢)
            const subsidy = 29 * quantity;
            
            // 超级联盟 (1%)
            const superAlliance = Math.round((totalPrice - coupon - bundle) * 0.01);
            
            // 活动佣金 (1%)
            const activityCommission = Math.round((totalPrice - coupon - bundle) * 0.01);
            
            // 金币抵扣 (1%)
            const coinDeduction = Math.round((totalPrice - coupon - bundle) * 0.01);
            
            // 仓储成本
            const storageCost = 1.4 * quantity;
            
            // 总成本 (人民币)
            const totalCost = (purchase * quantity) + storageCost + shippingFee + lastMileShipping;
            
            // 总收入 (人民币)
            const totalIncome = (totalPrice - transactionFee - fsCb - commission - coupon - bundle + subsidy - superAlliance - activityCommission - coinDeduction) / exchangeRate;
            
            // 毛利
            const profit = totalIncome - totalCost;
            
            // 毛利率
            const profitRate = totalIncome > 0 ? (profit / totalIncome) * 100 : 0;
            
            // 上架价格
            const listingPrice = totalPrice / (1 - discount);
            
            // 更新显示
            document.getElementById('lt-total-cost').innerHTML = `${totalCost.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('lt-total-income').innerHTML = `${totalIncome.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('lt-profit').innerHTML = `${profit.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('lt-profit-rate').innerHTML = `${profitRate.toFixed(2)}%`;
            document.getElementById('lt-listing-price').innerHTML = `${Math.round(listingPrice).toLocaleString()}<span class="result-unit">泰铢</span>`;
            
            // 设置颜色
            document.getElementById('lt-profit').className = `result-value ${profit >= 0 ? 'profit' : 'loss'}`;
            document.getElementById('lt-profit-rate').className = `result-value ${profitRate >= 0 ? 'profit' : 'loss'}`;
        }
        
        // Lazada泰国海运计算函数
        function calculateLazadaThaiSea() {
            const quantity = parseFloat(document.getElementById('ls-quantity').value);
            const price = parseFloat(document.getElementById('ls-price').value);
            const purchase = parseFloat(document.getElementById('ls-purchase').value);
            const weight = parseFloat(document.getElementById('ls-weight').value);
            const exchangeRate = parseFloat(document.getElementById('ls-exchange-rate').value);
            const discount = parseFloat(document.getElementById('ls-discount').value);
            const couponRate = parseFloat(document.getElementById('ls-coupon').value);
            
            // 总售价
            const totalPrice = price * quantity;
            
            // 计算各项费用
            const bundle = 0; // 套装加购为0
            const coupon = (totalPrice - bundle) * couponRate;
            
            // 交易手续费 (3.21%)
            const transactionFee = Math.round((totalPrice - coupon - bundle) * 0.0321);
            
            // FS+CB (4%)
            const fsCb = Math.round((totalPrice - coupon - bundle) * 0.04);
            
            // 干线运输费 (0.006元/克)
            const shippingFee = (weight * quantity) * 0.006;
            
            // 佣金 (11.24%)
            const commission = Math.round((totalPrice - coupon - bundle) * 0.1124);
            
            // 尾程运费
            const lastMileShipping = 3 * quantity;
            
            // 补贴 (泰铢)
            const subsidy = 29 * quantity;
            
            // 超级联盟 (1%)
            const superAlliance = Math.round((totalPrice - coupon - bundle) * 0.01);
            
            // 活动佣金 (1%)
            const activityCommission = Math.round((totalPrice - coupon - bundle) * 0.01);
            
            // 金币抵扣 (1%)
            const coinDeduction = Math.round((totalPrice - coupon - bundle) * 0.01);
            
            // 仓储成本
            const storageCost = 1.4 * quantity;
            
            // 总成本 (人民币)
            const totalCost = (purchase * quantity) + storageCost + shippingFee + lastMileShipping;
            
            // 总收入 (人民币)
            const totalIncome = (totalPrice - transactionFee - fsCb - commission - coupon - bundle + subsidy - superAlliance - activityCommission - coinDeduction) / exchangeRate;
            
            // 毛利
            const profit = totalIncome - totalCost;
            
            // 毛利率
            const profitRate = totalIncome > 0 ? (profit / totalIncome) * 100 : 0;
            
            // 上架价格
            const listingPrice = totalPrice / (1 - discount);
            
            // 更新显示
            document.getElementById('ls-total-cost').innerHTML = `${totalCost.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('ls-total-income').innerHTML = `${totalIncome.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('ls-profit').innerHTML = `${profit.toFixed(2)}<span class="result-unit">元</span>`;
            document.getElementById('ls-profit-rate').innerHTML = `${profitRate.toFixed(2)}%`;
            document.getElementById('ls-listing-price').innerHTML = `${Math.round(listingPrice).toLocaleString()}<span class="result-unit">泰铢</span>`;
            
            // 设置颜色
            document.getElementById('ls-profit').className = `result-value ${profit >= 0 ? 'profit' : 'loss'}`;
            document.getElementById('ls-profit-rate').className = `result-value ${profitRate >= 0 ? 'profit' : 'loss'}`;
        }
        
        // 获取干线运输费率 (简化版本)
        function getShippingRate(weight, country) {
            if (country === 'vietnam') {
                // 越南干线费率表 (简化)
                if (weight <= 100) return 4400;
                if (weight <= 200) return 10800;
                if (weight <= 300) return 17200;
                if (weight <= 400) return 19240;
                if (weight <= 500) return 21280;
                return 21280 + Math.floor((weight - 500) / 100) * 2000;
            }
            return 0;
        }
        
        // 计算尾程运费
        function calculateLastMileShipping(weight) {
            if (weight <= 300) return 2.65;
            if (weight <= 1000) return 4.2;
            return 4.7;
        }
        
        // 页面加载时初始化计算
        window.onload = function() {
            calculateShopeeVietnam();
            calculateShopeeThailand();
            calculateShopeeLocal();
            calculateLazadaVietnam();
            calculateLazadaThailand();
            calculateLazadaThaiSea();
        };
    </script>
</body>
</html>
